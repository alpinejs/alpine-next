<html>
    <script src="http://alpine-next.test/dist/alpine.js" defer></script>

    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">

    <body class="bg-gray-100 text-gray-900 font-sans antialiased">
        <div class="flex items-center justify-center p-12" x-data="{ switchValue: false }">
            <div class="w-full max-w-xs mx-auto">
                <switch-group class="flex items-center space-x-4">
                    <switch-label>Enable notifications</switch-label>

                    <the-switch
                        x-model="switchValue"
                        class="relative inline-flex flex-shrink-0 h-6 transition-colors duration-200 ease-in-out border-2 border-transparent rounded-full cursor-pointer w-11 focus:outline-none focus:shadow-outline"
                        :class="switchValue ? 'bg-indigo-600' : 'bg-gray-200'"
                    >
                        <span
                            class="inline-block w-5 h-5 transition duration-200 ease-in-out transform bg-white rounded-full"
                            :class="{ 'translate-x-5': switchValue, 'translate-x-0': !switchValue }"
                        />
                    </the-switch>
                </switch-group>
            </div>
        </div>

        <template x-element="switch-group">
            <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">

            <div class="w-full max-w-xs mx-auto" x-data="{ api: { labelEl: null, switchEl: null} }" x-provide="api" x-init="Alpine.store('group')">
                <div class="flex items-center space-x-4">
                    <slot></slot>
                </div>
            </div>
        </template>

        <template x-element="switch-label" x-inject="api">
            <label
                x-data="{ id: Math.random().toString(36).substring(7) }"
                x-init="api.labelEl = $el"
                :id="'headlessui-switch-label-' + id"
                @pointerup="api.switchEl.click() && api.switchEl.focus({ preventScroll: true })"
            ><slot></slot></label>
        </template>

        <template x-element="the-switch" x-props="{ value: false }" x-inject="api">
            <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">

            <button
                x-init="if(api) api.switchEl = $el"
                @click.prevent="$dispatch('input', ! value)"
                @keyup.space.prevent="$dispatch('input', ! value)"
                @keypress.prevent
                role="switch"
                tabindex="0"
                :aria-checked="!! value"
                :aria-labelledby="api && api.labelEl.id"
            >
                <slot></slot>
            </button>
        </template>
    </body>
</html>

<!--
    Problems:
    - can't attach events from the <template> to the custom-element root in light-dom
 -->

<!-- Todo: work with "value" props and models -->

<!--
Alpine Portage || x-element?

Alpine Evolve || x-morph?

Alpine Evolve

Alpine Erode

Alpenglow

Glacier

Groves

Guide

Alpa

Altitude

Slide

Biome

Lake

Lodge

Tundra

Yak

Yodle

Cairn

Soar

Frost -->
